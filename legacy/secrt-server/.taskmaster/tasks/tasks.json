{
  "master": {
    "tasks": [
      {
        "id": 1,
        "title": "Prevent e2e tests from hitting rate limits",
        "description": "Integration/e2e tests in internal/api likely share the same in-memory rate limiter buckets across test cases, meaning tests that exercise create or claim endpoints can exhaust the token bucket and start getting 429s. Consider solutions such as: (a) injecting a no-op or high-limit rate limiter in test helpers, (b) exposing a rate limiter interface on Server so tests can swap it, (c) resetting buckets between tests, or (d) using per-test-unique IPs so each test gets its own bucket. Whatever approach is chosen should not weaken the production rate limiting contract.",
        "status": "pending",
        "priority": "medium",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": 2,
        "title": "Create privacy & security architecture page",
        "description": "Build a public-facing webpage (e.g. /security or /privacy) that explains secrt's privacy and security architecture in technical detail for advanced users. The page should answer 'how do I know I can trust you not to steal my secrets?' with concrete, verifiable claims.\n\nContent should cover:\n\n1. **Zero-knowledge architecture**: Client-side encryption (AES-256-GCM, HKDF, PBKDF2), keys never leave the browser, server stores only ciphertext, URL fragment (#) never sent to server.\n\n2. **One-time claim semantics**: Atomic DELETE-RETURNING in Postgres — secret is destroyed on read. No second chances, no copies.\n\n3. **IP privacy**: No raw IPs in logs (nginx truncation to /24 IPv4, /48 IPv6), HMAC-hashed IPs for rate limiting and owner keys (per-process random key, never persisted raw), X-Privacy-Log header verification.\n\n4. **Minimal logging**: No request bodies, no plaintext, no passphrases, no claim tokens in logs. Only method/path/status/bytes/duration/request_id.\n\n5. **TTL enforcement**: Secrets auto-expire, background reaper deletes expired rows. Claim path rejects expired secrets even before reaper runs.\n\n6. **Open source**: Link to the repo, specs, and audit-friendly code structure. Anyone can verify the claims.\n\n7. **What we CAN'T do**: We can't read your secrets (no key), we can't recover them (one-time delete), we can't link secrets to you (hashed IPs, no accounts for public use).\n\n8. **FAQ section** addressing common trust questions:\n   - What encryption is used?\n   - Can secrt staff read my secrets?\n   - What happens if someone intercepts the link?\n   - What if the server is compromised?\n   - Are secrets backed up?\n   - Do you log IP addresses?\n   - How is this different from other secret sharing services?\n   - Can I verify these claims myself?\n   - What about the passphrase option?\n   - What metadata do you store?\n\nDesign: Should match the existing site aesthetic. Consider using the frontend-design skill for a polished result. The page should be technically rigorous but accessible — a security engineer should find it satisfying, while a non-technical user should still understand the key points.",
        "status": "pending",
        "priority": "medium",
        "dependencies": [],
        "subtasks": [
          {
            "id": 1,
            "title": "Draft content and FAQ answers",
            "description": "Write all section content and FAQ Q&A pairs, referencing specs and source code for accuracy.",
            "status": "pending"
          },
          {
            "id": 2,
            "title": "Build the page",
            "description": "Create the HTML/CSS page in web/ matching the existing site design, with proper routing in the Go server.",
            "status": "pending"
          },
          {
            "id": 3,
            "title": "Review for accuracy against specs",
            "description": "Cross-check all claims against spec/v1/*.md, middleware.go, server.go, and storage code to ensure nothing is overstated.",
            "status": "pending"
          }
        ]
      },
      {
        "id": 3,
        "title": "Create documentation pages with configuration reference",
        "description": "Build a docs section of the site with a landing page and a configuration reference page at /docs/config. Pages are served as inline HTML in pages.go (like the existing / and /s/{id} handlers), styled with Tailwind CSS matching the dark zinc/emerald theme.\n\n## Docs landing page (`GET /docs`)\n\nA hub linking to the config page and any future doc pages. Brief intro to secrt, links to:\n- Configuration reference (/docs/config)\n- Security & privacy architecture (task #2, future)\n- API reference (link to spec/v1/api.md or future page)\n- CLI usage (link to secrt-rs repo)\n\n## Configuration reference page (`GET /docs/config`)\n\nComprehensive reference for all environment variables and runtime settings. Organized by category:\n\n### Environment & Server\n| Variable | Default | Description |\n|----------|---------|-------------|\n| `ENV` | `development` | `production` enforces strict validation, disables .env loading |\n| `LISTEN_ADDR` | `:8080` | HTTP bind address |\n| `PUBLIC_BASE_URL` | `http://localhost:8080` | Base URL for share links |\n| `LOG_LEVEL` | `info` | `debug`, `info`, `warn`, `error` |\n\n### Database\n| Variable | Default | Description |\n|----------|---------|-------------|\n| `DATABASE_URL` | — | Full Postgres connection string (overrides DB_* vars) |\n| `DB_HOST` | `127.0.0.1` | Postgres host |\n| `DB_PORT` | `5432` | Postgres port |\n| `DB_NAME` | `secrt` | Database name |\n| `DB_USER` | `secrt_app` | Database user |\n| `DB_PASSWORD` | — | Database password |\n| `DB_SSLMODE` | `disable` | SSL mode |\n| `DB_SSLROOTCERT` | — | Path to SSL root CA cert |\n\n### Security\n| Variable | Default | Description |\n|----------|---------|-------------|\n| `API_KEY_PEPPER` | — | HMAC pepper for API key verification (required in production) |\n\n### Storage & Quotas\n| Variable | Default | Description |\n|----------|---------|-------------|\n| `PUBLIC_MAX_ENVELOPE_BYTES` | `262144` (256 KiB) | Max envelope size (public) |\n| `AUTHED_MAX_ENVELOPE_BYTES` | `1048576` (1 MiB) | Max envelope size (authenticated) |\n| `PUBLIC_MAX_SECRETS` | `10` | Max active secrets per IP |\n| `PUBLIC_MAX_TOTAL_BYTES` | `2097152` (2 MiB) | Max total storage per IP |\n| `AUTHED_MAX_SECRETS` | `1000` | Max active secrets per API key |\n| `AUTHED_MAX_TOTAL_BYTES` | `20971520` (20 MiB) | Max total storage per API key |\n\n### Hardcoded Runtime Constants\nAlso document non-configurable values: HTTP timeouts (5s/15s/15s/60s), DB pool (10/10/30m), rate limits (public create 0.5rps burst 6, claim 1.0rps burst 10, authed create 2.0rps burst 20), reaper interval (5m), graceful shutdown (10s), default TTL (24h), max TTL (1 year).\n\n## Implementation notes\n\n- Add `handleDocs` and `handleDocsConfig` handlers in `pages.go`\n- Register routes in `server.go`: `GET /docs` and `GET /docs/config`\n- Same response headers as other pages: `Cache-Control: no-store`, `X-Robots-Tag: noindex`\n- Use the same inline HTML pattern (fmt.Fprint) as existing pages\n- Keep values in sync with `internal/config/config.go` — reference the actual defaults from the source\n- Rebuild Tailwind output.css if new classes are used",
        "status": "pending",
        "priority": "medium",
        "dependencies": [],
        "subtasks": [
          {
            "id": 1,
            "title": "Add route handlers and registration",
            "description": "Create handleDocs and handleDocsConfig in pages.go, register GET /docs and GET /docs/config in server.go.",
            "status": "pending"
          },
          {
            "id": 2,
            "title": "Build docs landing page HTML",
            "description": "Write the /docs landing page with navigation links to config and other future sections, matching site aesthetic.",
            "status": "pending"
          },
          {
            "id": 3,
            "title": "Build config reference page HTML",
            "description": "Write the /docs/config page with all env vars, defaults, descriptions, and hardcoded constants in well-organized tables.",
            "status": "pending"
          },
          {
            "id": 4,
            "title": "Rebuild Tailwind CSS and verify",
            "description": "Run Tailwind build to pick up any new classes, verify pages render correctly.",
            "status": "pending"
          }
        ]
      }
    ]
  }
}
