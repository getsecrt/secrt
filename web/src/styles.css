@import 'tailwindcss';
@custom-variant dark (&:where(.dark, .dark *):not(:where(.light, .light *)));

@theme {
  /* Green palette — hue 140–147, chroma peaks at 400, even lightness steps */
  --color-green-50: oklch(0.97 0.04 140);
  --color-green-100: oklch(0.94 0.08 140);
  --color-green-200: oklch(0.9 0.14 141);
  --color-green-300: oklch(0.84 0.19 142);
  --color-green-400: oklch(0.76 0.22 142);
  --color-green-500: oklch(0.67 0.23 143);
  --color-green-600: oklch(0.58 0.19 144);
  --color-green-700: oklch(0.48 0.15 145);
  --color-green-800: oklch(0.39 0.11 146);
  --color-green-900: oklch(0.31 0.08 146);
  --color-green-950: oklch(0.21 0.05 147);

  --color-neutral-150: oklch(0.95 0 0);

  /* Surfaces & borders (neutral scale) */
  --color-bg: #fff;
  --color-surface: #fff;
  --color-surface-raised: var(--color-neutral-100);
  --color-border: var(--color-neutral-200);

  /* Text (neutral scale) */
  --color-text: var(--color-neutral-900);
  --color-text-muted: var(--color-neutral-600);
  --color-text-faint: var(--color-neutral-400);

  /* Semantic accent (custom green palette) */
  --color-accent: var(--color-green-700);
  --color-accent-bright: var(--color-green-400);
  --color-accent-hover: var(--color-green-600);

  /* Status */
  --color-error: var(--color-red-600);
  --color-success: var(--color-green-600);

  /* Core scale */
  --spacing: 0.25rem;
  --font-sans: system-ui, -apple-system, sans-serif;
  --font-mono: 'SF Mono', Menlo, Consolas, monospace;
  --radius-lg: 10px;
  --shadow-sm: 0 1px 2px oklch(0 0 0 / 0.05);
  --max-width-sm: 480px;
}

:root.dark {
  --color-bg: var(--color-neutral-950);
  --color-surface: var(--color-neutral-900);
  --color-surface-raised: var(--color-neutral-800);
  --color-border: var(--color-neutral-700);
  --color-text: var(--color-neutral-100);
  --color-text-muted: var(--color-neutral-300);
  --color-text-faint: var(--color-neutral-500);
  --color-accent: var(--color-green-400);
  --color-accent-bright: var(--color-green-600);
  --color-accent-hover: var(--color-green-300);
  --color-error: var(--color-red-400);
  --color-success: var(--color-green-400);
  --shadow-sm: 0 1px 2px oklch(0 0 0 / 0.2);
}

@layer base {
  body {
    @apply bg-bg text-text antialiased;
  }

  .dark body {
    background-image:
      /* Broad green curtain — top-center, sweeping right */
      radial-gradient(
        ellipse 120% 50% at 60% 0%,
        color-mix(in oklch, var(--color-green-900) 25%, transparent),
        color-mix(in oklch, var(--color-green-950) 12%, transparent) 30%,
        transparent 5%
      ),
      /* Teal streak — upper-left, tall & narrow */
        radial-gradient(
          ellipse 35% 70% at 20% 10%,
          color-mix(in oklch, oklch(0.35 0.11 155) 22%, transparent),
          transparent 60%
        ),
      /* Emerald ribbon — offset right */
        radial-gradient(
          ellipse 40% 55% at 75% 15%,
          color-mix(in oklch, var(--color-green-800) 18%, transparent),
          transparent 65%
        ),
      /* Faint violet wisp — far left */
        radial-gradient(
          ellipse 25% 45% at 10% 25%,
          color-mix(in oklch, oklch(0.3 0.08 300) 10%, transparent),
          transparent 60%
        );
  }

  .link {
    @apply text-accent no-underline;
  }

  .link:hover {
    @apply underline;
    color: var(--color-accent-hover);
    text-underline-offset: 3px;
    text-decoration-color: color-mix(
      in oklch,
      var(--color-accent) 40%,
      transparent
    );
  }

  input[type='checkbox'],
  input[type='radio'] {
    width: 1.125rem; /* 18px, up from ~13px default */
    height: 1.125rem;
    accent-color: var(--color-green-600);
    cursor: pointer;
  }

  /* ── Consistent keyboard-focus indicator ── */
  a:focus-visible {
    outline: 2px solid color-mix(in oklch, var(--color-accent) 40%, transparent);
    outline-offset: 2px;
    border-radius: 2px;
  }

  button:focus-visible,
  summary:focus-visible,
  input[type='checkbox']:focus-visible,
  input[type='radio']:focus-visible {
    outline: 2px solid color-mix(in oklch, var(--color-accent) 40%, transparent);
    outline-offset: 2px;
  }
}

@layer components {
  .heading {
    @apply mb-3 border-b border-border pb-2 text-lg font-semibold tracking-widest text-neutral-700 uppercase dark:text-neutral-300 dark:text-shadow-black;
  }

  .btn {
    --btn-color: var(--color-neutral-200);
    --btn-fg: var(--color-text);
    --btn-highlight: 1.06;

    @apply relative inline-flex cursor-pointer items-center justify-center gap-1.5 rounded-md px-3 py-2 font-semibold tracking-wide duration-200 ease-out select-none;
    transition-property:
      filter, transform, box-shadow, background-color, border-color;
    color: var(--btn-fg);
    background-image: linear-gradient(
      to bottom,
      color-mix(in oklch, var(--btn-color), white 15%),
      color-mix(in oklch, var(--btn-color), black 10%)
    );
    border: 1px solid color-mix(in oklch, var(--btn-color), white 9%);
    border-top-color: color-mix(in oklch, var(--btn-color), white 40%);
    border-bottom-color: color-mix(in oklch, var(--btn-color), black 20%);
    box-shadow:
      0 1px 2px oklch(0 0 0 / 0.06),
      0 1px 3px oklch(0 0 0 / 0.1);
    text-shadow: 0 1px 1px oklch(1 0 0 / 0.9);

    .dark & {
      --btn-color: var(--color-neutral-600);
      --btn-highlight: 1.2;
      text-shadow: 0 1px 1px oklch(0 0 0 / 0.3);
    }
  }

  .btn:hover:not(:disabled) {
    filter: brightness(var(--btn-highlight));
  }

  .btn:active:not(:disabled) {
    filter: brightness(0.95);
    transform: translateY(0.5px);
    box-shadow:
      inset 0 2px 4px rgb(0 0 0 / 0.15),
      0 1px 2px rgb(0 0 0 / 0.1);
  }

  .btn:focus-visible {
    outline: 2px solid color-mix(in oklch, var(--color-accent) 40%, transparent);
    outline-offset: 2px;
  }

  .btn:disabled {
    @apply pointer-events-none opacity-50;
  }

  .btn-primary {
    --btn-color: var(--color-green-700);
    --btn-fg: #fff;
    --btn-highlight: 1.11;
    text-shadow: 0 1px 2px oklch(0 0 0 / 0.3);

    .dark & {
      --btn-color: var(--color-green-600);
    }
  }

  .btn-danger {
    --btn-color: var(--color-red-500);
    --btn-fg: #fff;
    --btn-highlight: 1.11;
    text-shadow: 0 1px 1px oklch(0 0 0 / 0.2);

    .dark & {
      --btn-color: var(--color-red-600);
    }
  }

  .btn-sm {
    @apply rounded-sm px-1.5 py-1 text-xs;
  }

  .btn-destructive-subtle {
    @apply flex items-center gap-1 rounded-md border border-transparent px-1 py-0.5 text-xs text-error/50 hover:border-error hover:bg-error/10 hover:text-error;
  }

  .code {
    @apply rounded border border-border/70 bg-surface-raised/70 px-1.5 py-0.5 font-mono text-xs;
  }

  /* ── Inputs ── */
  .input,
  .select,
  .textarea {
    @apply w-full rounded-md border border-border bg-surface px-3 py-2 text-text inset-shadow-sm transition-colors outline-none placeholder:text-neutral-500/50;
    &:focus {
      @apply border-accent ring-2 ring-accent/15;
    }
    &:disabled {
      @apply cursor-not-allowed bg-neutral-400/20 text-muted opacity-70;
    }
  }

  .input-error {
    @apply border-error;
    &:focus {
      @apply border-error ring-2 ring-error/15;
    }
  }

  .select {
    @apply appearance-none bg-[length:1.25rem] bg-[right_0.5rem_center] bg-no-repeat pr-8;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%2371717a'%3E%3Cpath fill-rule='evenodd' d='M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z'/%3E%3C/svg%3E");
  }

  .textarea {
    @apply resize-y;
  }

  .card {
    @apply rounded-lg border border-neutral-300/50 bg-neutral-100 p-6 shadow-md backdrop-blur-md dark:border-neutral-700/35 dark:bg-neutral-950/40;
  }
}

@utility text-muted {
  color: var(--color-text-muted);
}
@utility text-faint {
  color: var(--color-text-faint);
}
@utility inset-shadow-border-3 {
  --tw-inset-shadow:
    inset 1px 0 0 0 color-mix(in srgb, var(--color-border) 50%, transparent),
    inset -1px 0 0 0 color-mix(in srgb, var(--color-border) 50%, transparent),
    inset 0 -1px 0 0 color-mix(in srgb, var(--color-border) 50%, transparent);
}
