# Core
ENV=production
# Bind address for HTTP listener (usually loopback behind reverse proxy).
LISTEN_ADDR=127.0.0.1:8080
# Public origin used to build share URLs returned by the API.
PUBLIC_BASE_URL=https://secrt.ca
# tracing filter level: error | warn | info | debug | trace
LOG_LEVEL=info

# Database (set DATABASE_URL or the DB_* fields below)
# If DATABASE_URL is set, DB_* fields are ignored.
# DATABASE_URL=postgres://secrt_app:password@127.0.0.1:5432/secrt?sslmode=disable
DB_HOST=127.0.0.1
DB_PORT=5432
DB_NAME=secrt
DB_USER=secrt_app
DB_PASSWORD=
# disable | require | verify-ca | verify-full
DB_SSLMODE=disable
# Path to CA cert file when DB_SSLMODE uses certificate verification.
DB_SSLROOTCERT=

# Security (required when ENV=production)
# HMAC pepper for API-key verifier hashes stored in the database.
API_KEY_PEPPER=
# HMAC pepper for hashed session bearer token secrets at rest.
SESSION_TOKEN_PEPPER=

# Secret size/quota limits (defaults)
# Max envelope JSON bytes for anonymous create requests.
PUBLIC_MAX_ENVELOPE_BYTES=262144
# Max envelope JSON bytes for authenticated create requests.
AUTHED_MAX_ENVELOPE_BYTES=1048576
# Max active secrets per anonymous owner (IP-derived owner key).
PUBLIC_MAX_SECRETS=10
# Max active stored bytes per anonymous owner.
PUBLIC_MAX_TOTAL_BYTES=2097152
# Max active secrets per authenticated API key owner.
AUTHED_MAX_SECRETS=1000
# Max active stored bytes per authenticated API key owner.
AUTHED_MAX_TOTAL_BYTES=20971520

# Rate limits (defaults)
# Public create token-bucket rate (requests/second).
PUBLIC_CREATE_RATE=0.5
# Public create token-bucket burst size.
PUBLIC_CREATE_BURST=6
# Claim token-bucket rate (requests/second).
CLAIM_RATE=1.0
# Claim token-bucket burst size.
CLAIM_BURST=10
# Authenticated create token-bucket rate (requests/second).
AUTHED_CREATE_RATE=2.0
# Authenticated create token-bucket burst size.
AUTHED_CREATE_BURST=20

# API key registration limits/throttle (defaults)
# API key registration token-bucket rate (requests/second), keyed by client IP.
APIKEY_REGISTER_RATE=0.5
# API key registration token-bucket burst size.
APIKEY_REGISTER_BURST=6
# Hard cap per account in a rolling 1-hour window.
APIKEY_REGISTER_ACCOUNT_MAX_PER_HOUR=5
# Hard cap per account in a rolling 24-hour window.
APIKEY_REGISTER_ACCOUNT_MAX_PER_DAY=20
# Hard cap per client IP in a rolling 1-hour window.
APIKEY_REGISTER_IP_MAX_PER_HOUR=5
# Hard cap per client IP in a rolling 24-hour window.
APIKEY_REGISTER_IP_MAX_PER_DAY=20
